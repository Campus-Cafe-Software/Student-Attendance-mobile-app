(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3e61b606"],{5319:function(t,e,n){"use strict";var r=n("d784"),o=n("825a"),s=n("7b0b"),i=n("50c4"),c=n("a691"),u=n("1d80"),a=n("8aa5"),l=n("14c3"),d=Math.max,h=Math.min,b=Math.floor,g=/\$([$&'`]|\d\d?|<[^>]*>)/g,m=/\$([$&'`]|\d\d?)/g,f=function(t){return void 0===t?t:String(t)};r("replace",2,(function(t,e,n,r){var k=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,p=r.REPLACE_KEEPS_$0,y=k?"$":"$0";return[function(n,r){var o=u(this),s=void 0==n?void 0:n[t];return void 0!==s?s.call(n,o,r):e.call(String(o),n,r)},function(t,r){if(!k&&p||"string"===typeof r&&-1===r.indexOf(y)){var s=n(e,t,this,r);if(s.done)return s.value}var u=o(t),b=String(this),g="function"===typeof r;g||(r=String(r));var m=u.global;if(m){var C=u.unicode;u.lastIndex=0}var T=[];while(1){var j=l(u,b);if(null===j)break;if(T.push(j),!m)break;var D=String(j[0]);""===D&&(u.lastIndex=a(b,i(u.lastIndex),C))}for(var v="",I=0,S=0;S<T.length;S++){j=T[S];for(var A=String(j[0]),w=d(h(c(j.index),b.length),0),H=[],x=1;x<j.length;x++)H.push(f(j[x]));var N=j.groups;if(g){var _=[A].concat(H,w,b);void 0!==N&&_.push(N);var $=String(r.apply(void 0,_))}else $=O(A,b,w,H,N,r);w>=I&&(v+=b.slice(I,w)+$,I=w+A.length)}return v+b.slice(I)}];function O(t,n,r,o,i,c){var u=r+t.length,a=o.length,l=m;return void 0!==i&&(i=s(i),l=g),e.call(c,l,(function(e,s){var c;switch(s.charAt(0)){case"$":return"$";case"&":return t;case"`":return n.slice(0,r);case"'":return n.slice(u);case"<":c=i[s.slice(1,-1)];break;default:var l=+s;if(0===l)return e;if(l>a){var d=b(l/10);return 0===d?e:d<=a?void 0===o[d-1]?s.charAt(1):o[d-1]+s.charAt(1):e}c=o[l-1]}return void 0===c?"":c}))}}))},"565f":function(t,e,n){"use strict";n.r(e);var r=n("7a23"),o={style:{margin:"0px","font-weight":"bold"}},s=Object(r["g"])("IN"),i=Object(r["g"])("OUT"),c=Object(r["h"])("hr",{style:{"border-width":"1px",margin:"0 20px"}},null,-1),u=Object(r["g"])("Add Time"),a=Object(r["g"])(" Update "),l={key:0,style:{color:"red",padding:"0 30px","text-align":"center"}},d={key:0,style:{color:"red",padding:"0 30px","text-align":"center"}};function h(t,e,n,h,b,g){var m=Object(r["y"])("ion-img"),f=Object(r["y"])("ion-col"),k=Object(r["y"])("ion-row"),p=Object(r["y"])("ion-grid"),y=Object(r["y"])("ion-datetime"),O=Object(r["y"])("ion-icon"),C=Object(r["y"])("ion-button"),T=Object(r["y"])("base-layout");return Object(r["q"])(),Object(r["e"])(T,{"page-title":"Edit Times","page-default-back-link":"studentList"},{default:Object(r["D"])((function(){return[Object(r["h"])(p,null,{default:Object(r["D"])((function(){return[Object(r["h"])(k,null,{default:Object(r["D"])((function(){return[Object(r["h"])(f,{size:"12",style:{"text-align":"center"}},{default:Object(r["D"])((function(){return[Object(r["h"])("div",null,[Object(r["h"])(m,{src:b.student.imageURI,style:{width:"100px",margin:"auto","margin-bottom":"10px"}},null,8,["src"])]),Object(r["h"])("h2",o,Object(r["A"])(b.student.firstName)+" "+Object(r["A"])(b.student.lastName),1),Object(r["h"])("h3",null,"(ID: "+Object(r["A"])(b.student.studentId)+")",1)]})),_:1})]})),_:1})]})),_:1}),Object(r["h"])(p,null,{default:Object(r["D"])((function(){return[Object(r["h"])(k,null,{default:Object(r["D"])((function(){return[Object(r["h"])(f,{size:"5",style:{"text-align":"center"}},{default:Object(r["D"])((function(){return[s]})),_:1}),Object(r["h"])(f,{size:"4",style:{"text-align":"center"}},{default:Object(r["D"])((function(){return[i]})),_:1}),Object(r["h"])(f,{size:"3",style:{"margin-left":"25px","text-align":"center"}})]})),_:1})]})),_:1}),c,Object(r["h"])(p,null,{default:Object(r["D"])((function(){return[(Object(r["q"])(!0),Object(r["e"])(r["a"],null,Object(r["w"])(b.student.clockHistory,(function(t,e){return Object(r["q"])(),Object(r["e"])("div",{key:t.clockId},[null!=t.instructorClockInDateTime&&void 0!=t.instructorClockInDateTime&&""!=t.instructorClockInDateTime?(Object(r["q"])(),Object(r["e"])(k,{key:0},{default:Object(r["D"])((function(){return[Object(r["h"])(f,{size:"5",style:{"text-align":"center"}},{default:Object(r["D"])((function(){return[Object(r["h"])(y,{"display-format":"h:mm A","picker-format":"h:mm A",modelValue:t.instructorClockInDateTime,"onUpdate:modelValue":function(e){return t.instructorClockInDateTime=e},value:t.instructorClockInDateTime,onIonChange:function(e){t.instructorClockInDateTime=e.target.value,t.modify=2,b.anythingChanged=!0}},null,8,["modelValue","onUpdate:modelValue","value","onIonChange"])]})),_:2},1024),Object(r["h"])(f,{size:"4",style:{"text-align":"center"}},{default:Object(r["D"])((function(){return[Object(r["h"])(y,{"display-format":"h:mm A","picker-format":"h:mm A",modelValue:t.instructorClockOutDateTime,"onUpdate:modelValue":function(e){return t.instructorClockOutDateTime=e},value:t.instructorClockOutDateTime,onIonChange:function(e){t.instructorClockOutDateTime=e.target.value,t.modify=2,b.anythingChanged=!0}},null,8,["modelValue","onUpdate:modelValue","value","onIonChange"])]})),_:2},1024),Object(r["h"])(f,{size:"3",style:{"text-align":"center"}},{default:Object(r["D"])((function(){return[Object(r["h"])(C,{onClick:function(t){return g.removeSelectedTime(e)},style:{height:"26px","--background":"#517FC8"}},{default:Object(r["D"])((function(){return[Object(r["h"])(O,{slot:"icon-only",icon:b.closeCircleOutline},null,8,["icon"])]})),_:1},8,["onClick"])]})),_:1})]})),_:2},1024)):Object(r["f"])("",!0)])})),128))]})),_:1}),Object(r["h"])(p,null,{default:Object(r["D"])((function(){return[Object(r["h"])(k,null,{default:Object(r["D"])((function(){return[Object(r["h"])(f,{size:"12"},{default:Object(r["D"])((function(){return[Object(r["h"])(C,{onClick:e[1]||(e[1]=function(t){return g.addNewTime(b.student)}),style:{"--background":"#517FC8",padding:"0 90px"},expand:"block"},{default:Object(r["D"])((function(){return[Object(r["h"])(O,{slot:"start",icon:b.addCircleOutline},null,8,["icon"]),u]})),_:1})]})),_:1})]})),_:1})]})),_:1}),1==b.anythingChanged?(Object(r["q"])(),Object(r["e"])(p,{key:0},{default:Object(r["D"])((function(){return[Object(r["h"])(k,null,{default:Object(r["D"])((function(){return[Object(r["h"])(f,{size:"12"},{default:Object(r["D"])((function(){return[Object(r["h"])(C,{expand:"block",onClick:g.onSubmit,style:{"--background":"#ff796a"}},{default:Object(r["D"])((function(){return[Object(r["h"])(O,{slot:"start",icon:b.createOutline},null,8,["icon"]),a]})),_:1},8,["onClick"])]})),_:1})]})),_:1})]})),_:1})):Object(r["f"])("",!0),Object(r["h"])(k,null,{default:Object(r["D"])((function(){return[b.errorCount>0?(Object(r["q"])(),Object(r["e"])("h2",l,Object(r["A"])(b.errorCount)+" server errors found on submit. "+Object(r["A"])(b.error250),1)):Object(r["f"])("",!0)]})),_:1}),Object(r["h"])(k,null,{default:Object(r["D"])((function(){return[1==b.errorAbsent?(Object(r["q"])(),Object(r["e"])("h2",d,"Error found on Mark Absent.")):Object(r["f"])("",!0)]})),_:1})]})),_:1})}n("d3b7"),n("ac1f"),n("25f0"),n("5319"),n("1276"),n("96cf");var b=n("1da1"),g=n("8a30"),m=n("ff79"),f={props:{studentID:{type:String,required:!0},classID:{type:String,required:!0}},components:{},data:function(){return{students:[],student:{},studentOrig:{},submitActionList:[],classes:[],cuInsClass:{},timeInOut:[],userName:"",createOutline:m["l"],closeCircleOutline:m["j"],addCircleOutline:m["a"],semester:"",courseNumber:"",courseSection:"",labSection:"",studentId:"",errorCount:0,error250:"",errorAbsent:!1,checkIsAbsent:!1,anythingChanged:!1,actionCount:0}},methods:{updateTime:function(t){console.log(t)},search:function(t,e){for(var n=0;n<e.length;n++)if(e[n].studentID===t)return e[n]},getTodayDay:function(){var t=new Date,e=t.getFullYear().toString(),n=t.getMonth()+1;n<10&&(n="0"+n.toString());var r=t.getDate();return r<10&&(r="0"+r.toString()),t.getDate(),e+n+r},changeTimeTo12:function(t){if(null==t||void 0==t||""==t)return"";var e=t.split("T")[1].split(":")[0],n=t.split("T")[1].split(":")[1],r=" AM";return"0"==e[0]?(r=" AM",e=e[1]):e<=11?r=" AM":12==e?r=" PM":e>12&&(r=" PM",e-=12),e+":"+n+r},getStudents:function(){this.students=this.$store.getters.getStudentList,console.log("all students = "+JSON.stringify(this.students)),this.student=this.cleanUpData(this.$store.getters.cuStudentList(this.$route.params.sid)),this.studentOrig=JSON.parse(JSON.stringify(this.student)),console.log("current student = "+JSON.stringify(this.student)),this.cuInsClass=this.$store.getters.cuInsClass(this.$route.params.cid);var t={id:"100"};window.history.replaceState(t,"Attendance","/cafeweb/mobile/"),this.toCheckIsAbsent()},removeSelectedTime:function(t){console.log(t),this.student.clockHistory[t].instructorClockInDateTime="",this.student.clockHistory[t].instructorClockOutDateTime="",this.student.clockHistory[t].modify=3,console.log("current student = "+JSON.stringify(this.student)),this.anythingChanged=!0},addNewTime:function(){console.log(this.student),console.log("current student = "+JSON.stringify(this.student));var t=(new Date).toLocaleDateString("fr-CA",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).replace(", ","T").replace(" h ",":");console.log("current student = "+JSON.stringify(this.student));var e={};e={clockId:"",studentClockInDateTime:"",studentClockOutDateTime:"",instructorClockInDateTime:t,instructorClockOutDateTime:t,isAbsent:"",modify:1,canDel:!0,isNew:!0},this.student.clockHistory.push(e),console.log("current student with added time = "+JSON.stringify(this.student)),this.anythingChanged=!0},editSelectedTime:function(t){console.log("current student = "+JSON.stringify(this.student));var e=(new Date).toLocaleDateString("fr-CA",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).replace(", ","T").replace(" h ",":");this.student.clockHistory[t].instructorClockInDateTime=e,this.student.clockHistory[t].instructorClockOutDateTime=e,1!=this.student.clockHistory[t].modify&&(this.student.clockHistory[t].modify=2),console.log("current student = "+JSON.stringify(this.student)),this.anythingChanged=!0},onSubmit:function(){console.log("-new student = "+JSON.stringify(this.student)),console.log("-old student = "+JSON.stringify(this.studentOrig)),this.errorCount=0;var t=0;this.paddingstudentOrig();for(var e=0;e<this.student.clockHistory.length;e++)switch(this.student.clockHistory[e].isNew&&(this.student.clockHistory[e].modify=1),this.student.clockHistory[e].modify){case 0:console.log(e+" do nothing.");break;case 1:console.log(e+" instructorClock is new"),this.actionCount++,this.submitNewTime(e);break;case 2:console.log(e+" instructorClock is updated"),this.actionCount++,this.submitUpdateTime(e);break;case 3:console.log(e+" instructorClock is deleted"),1==this.student.clockHistory[e].canDel&&(this.actionCount++,this.submitDelTime(e)),t++;break}this.student.clockHistory.length==t&&(this.submitAddAbsent(),this.actionCount++)},submitNewTime:function(t){var e=this,n=this.$store.getters.getToken;console.log("token is "+n);var r={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.getters.getToken}};fetch("/cafeweb/mobileApi/instructor/studentClockTime?semester="+this.cuInsClass.semester+"&courseNumber="+this.cuInsClass.courseNumber+"&courseSection="+this.cuInsClass.courseSection+"&labSection="+this.cuInsClass.labSection+"&date="+this.getTodayDay()+"&studentId="+this.student.studentId+"&clockIn="+this.student.clockHistory[t].instructorClockInDateTime+"&clockOut="+this.student.clockHistory[t].instructorClockOutDateTime,r).then(function(){var n=Object(b["a"])(regeneratorRuntime.mark((function n(r){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r.ok){n.next=6;break}return e.errorCount++,e.openToastFailed(),n.abrupt("return",Promise.reject(r.status));case 6:if(250!=r.status){n.next=11;break}return e.errorCount++,e.openToastFailed(),e.error250="There is a time input error, either the check in time is later than checkout time, or the same time is already entered. Go back to the previous page reload, then try again.",n.abrupt("return",Promise.reject(r.status));case 11:console.log("added new time "+t),e.openToastSuccessful();case 13:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()).catch((function(t){e.errorMessage=t,console.error("There was an error!",t),e.errorCount++,e.openToastFailed()}))},submitUpdateTime:function(t){var e=this,n=this.$store.getters.getToken;console.log("token is "+n);var r={method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.getters.getToken}};fetch("/cafeweb/mobileApi/instructor/studentClockTime?semester="+this.cuInsClass.semester+"&courseNumber="+this.cuInsClass.courseNumber+"&courseSection="+this.cuInsClass.courseSection+"&labSection="+this.cuInsClass.labSection+"&date="+this.getTodayDay()+"&studentId="+this.student.studentId+"&clockId="+this.student.clockHistory[t].clockId+"&clockIn="+this.student.clockHistory[t].instructorClockInDateTime+"&clockOut="+this.student.clockHistory[t].instructorClockOutDateTime,r).then(function(){var n=Object(b["a"])(regeneratorRuntime.mark((function n(r){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r.ok){n.next=6;break}return e.errorCount++,e.openToastFailed(),n.abrupt("return",Promise.reject(r.status));case 6:if(250!=r.status){n.next=11;break}return e.errorCount++,e.error250="There is a time input error, either the check in time is later than checkout time, or the same time is already entered. Go back to the previous page reload, then try again.",e.openToastFailed(),n.abrupt("return",Promise.reject(r.status));case 11:console.log("updated old time"+t),e.openToastSuccessful();case 13:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()).catch((function(t){e.errorMessage=t,console.error("There was an error!",t),e.errorCount++,e.openToastFailed()}))},submitDelTime:function(t){var e=this,n=this.$store.getters.getToken;console.log("token is "+n);var r={method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.getters.getToken}};fetch("/cafeweb/mobileApi/instructor/studentClockTime?semester="+this.cuInsClass.semester+"&courseNumber="+this.cuInsClass.courseNumber+"&courseSection="+this.cuInsClass.courseSection+"&labSection="+this.cuInsClass.labSection+"&date="+this.getTodayDay()+"&studentId="+this.student.studentId+"&clockId="+this.student.clockHistory[t].clockId,r).then(function(){var n=Object(b["a"])(regeneratorRuntime.mark((function n(r){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r.ok){n.next=4;break}return e.errorCount++,e.openToastFailed(),n.abrupt("return",Promise.reject(r.status));case 4:console.log("updated old time"+t),e.openToastSuccessful();case 6:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()).catch((function(t){e.errorMessage=t,console.error("There was an error!",t),e.errorCount++,e.openToastFailed()}))},submitAddAbsent:function(){var t=this,e=this.$store.getters.getToken;console.log("token is "+e);var n={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.getters.getToken}};fetch("/cafeweb/mobileApi/instructor/studentAbsent?semester="+this.cuInsClass.semester+"&courseNumber="+this.cuInsClass.courseNumber+"&courseSection="+this.cuInsClass.courseSection+"&labSection="+this.cuInsClass.labSection+"&date="+this.getTodayDay()+"&studentId="+this.student.studentId,n).then(function(){var e=Object(b["a"])(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n.ok){e.next=4;break}return t.errorCount++,t.errorAbsent=!0,e.abrupt("return",Promise.reject(n.status));case 4:console.log("mark absent Y"),t.errorAbsent=!1,t.openToastSuccessful();case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.errorMessage=e,console.error("There was an error!",e),t.errorCount++,t.errorAbsent=!0}))},submitDelAbsent:function(){var t=this,e=this.$store.getters.getToken;console.log("token is "+e);var n={method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.getters.getToken}};fetch("/cafeweb/mobileApi/instructor/studentAbsent?semester="+this.cuInsClass.semester+"&courseNumber="+this.cuInsClass.courseNumber+"&courseSection="+this.cuInsClass.courseSection+"&labSection="+this.cuInsClass.labSection+"&date="+this.getTodayDay()+"&studentId="+this.student.studentId+"&clockId="+this.student.clockHistory[0].clockId,n).then(function(){var e=Object(b["a"])(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n.ok){e.next=4;break}return t.errorCount++,t.errorAbsent=!0,e.abrupt("return",Promise.reject(n.status));case 4:console.log("mark absent N"),t.errorAbsent=!1;case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.errorMessage=e,console.error("There was an error!",e),t.errorCount++,t.errorAbsent=!0}))},hasClock:function(){var t=!1;if(this.student.clockHistory.length>0){for(var e=0;e<this.student.clockHistory.length;e++)(this.student.clockHistory[e].studentClockInDateTime.length>4||this.student.clockHistory[e].studentClockOutDateTime.length>4||this.student.clockHistory[e].instructorClockInDateTime.length>4||this.student.clockHistory[e].instructorClockOutDateTime.length>4)&&(t=!0);return t}return t},cleanUpData:function(t){if(t.clockHistory.length>0)for(var e=0;e<t.clockHistory.length;e++)void 0==t.clockHistory[e].clockId&&(t.clockHistory[e]["clockId"]=""),void 0==t.clockHistory[e].studentClockInDateTime&&(t.clockHistory[e]["studentClockInDateTime"]=""),void 0==t.clockHistory[e].studentClockOutDateTime&&(t.clockHistory[e]["studentClockOutDateTime"]=""),void 0!=t.clockHistory[e].instructorClockInDateTime&&""!=t.clockHistory[e].instructorClockInDateTime||(t.clockHistory[e]["instructorClockInDateTime"]=t.clockHistory[e]["studentClockInDateTime"]),void 0!=t.clockHistory[e].instructorClockOutDateTime&&""!=t.clockHistory[e].instructorClockOutDateTime||(t.clockHistory[e]["instructorClockOutDateTime"]=t.clockHistory[e]["studentClockOutDateTime"]),void 0==t.clockHistory[e].isAbsent&&(t.clockHistory[e]["isAbsent"]=""),t.clockHistory[e]["modify"]=0;return console.log("after cleanup student = "+JSON.stringify(t)),t},paddingstudentOrig:function(){if(this.student.clockHistory.length>this.studentOrig.clockHistory.length)for(var t=0;t<this.student.clockHistory.length-this.studentOrig.clockHistory.length;t++)this.studentOrig.clockHistory.push({clockId:"",studentClockInDateTime:"",studentClockOutDateTime:"",instructorClockInDateTime:"",instructorClockOutDateTime:"",isAbsent:"",modify:0,isNew:!1})},markAbsent:function(t){console.log(t.detail.checked),t.detail.checked?this.submitAddAbsent():this.submitDelAbsent()},toCheckIsAbsent:function(){if(this.student.clockHistory.length>0)for(var t=0;t<this.student.clockHistory.length;t++)"Y"==this.student.clockHistory[t].isAbsent&&(this.checkIsAbsent=!0);else 0==this.student.clockHistory.length&&(this.checkIsAbsent=!0)},openToastSuccessful:function(){var t=this;return Object(b["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.actionCount--,0!=t.actionCount){e.next=7;break}return e.next=4,g["q"].create({message:"Submit Successful.",position:"top",duration:1e3,color:"success"});case 4:n=e.sent,n.present(),n.onDidDismiss().then((function(){t.$router.go(-1)}));case 7:case"end":return e.stop()}}),e)})))()},openToastFailed:function(){return Object(b["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,g["q"].create({message:"Failed submit, server error, please try again.",position:"top",duration:1e3,color:"danger"});case 2:e=t.sent,e.present();case 4:case"end":return t.stop()}}),t)})))()}},mounted:function(){this.getStudents(),console.log("classID = "+this.$route.params.cid),console.log("studentID = "+this.$route.params.sid)}};f.render=h;e["default"]=f}}]);
//# sourceMappingURL=chunk-3e61b606.e9a205ac.js.map